{% extends "base.html" %}
{% load static %}

{% block title %}Faculty Dashboard{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header -->
    <div>
        <h1 class="text-2xl font-bold text-slate-900">Dashboard</h1>
        <p class="text-slate-500">Overview of examinations and activity</p>
    </div>

    <!-- Stats Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Total Exams -->
        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
            <div class="flex items-center gap-4">
                <div class="p-3 bg-blue-50 text-blue-600 rounded-lg">
                    <i class="fa-solid fa-file-lines text-xl"></i>
                </div>
                <div>
                    <p class="text-sm font-medium text-slate-500">Total Exams</p>
                    <h3 class="text-2xl font-bold text-slate-900">{{ total_exams }}</h3>
                </div>
            </div>
        </div>

        <!-- Students -->
        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
            <div class="flex items-center gap-4">
                <div class="p-3 bg-indigo-50 text-indigo-600 rounded-lg">
                    <i class="fa-solid fa-users text-xl"></i>
                </div>
                <div>
                    <p class="text-sm font-medium text-slate-500">Students</p>
                    <h3 class="text-2xl font-bold text-slate-900">{{ total_students }}</h3>
                </div>
            </div>
        </div>

        <!-- Completed Exams -->
        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
            <div class="flex items-center gap-4">
                <div class="p-3 bg-emerald-50 text-emerald-600 rounded-lg">
                    <i class="fa-solid fa-circle-check text-xl"></i>
                </div>
                <div>
                    <p class="text-sm font-medium text-slate-500">Completed</p>
                    <h3 class="text-2xl font-bold text-slate-900">{{ completed_exams }}</h3>
                </div>
            </div>
        </div>

        <!-- Upcoming Exams -->
        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
            <div class="flex items-center gap-4">
                <div class="p-3 bg-amber-50 text-amber-600 rounded-lg">
                    <i class="fa-solid fa-clock text-xl"></i>
                </div>
                <div>
                    <p class="text-sm font-medium text-slate-500">Upcoming</p>
                    <h3 class="text-2xl font-bold text-slate-900">{{ upcoming_exams }}</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Exams Table -->
    <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
        <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center">
            <h2 class="text-lg font-semibold text-slate-900">Recent Exams</h2>
            <a href="{% url 'view_exams' %}" class="text-sm text-primary hover:text-indigo-700 font-medium">View All</a>
        </div>
        <div class="overflow-x-auto">
            <table class="w-full text-left">
                <thead class="bg-slate-100 text-slate-500 text-xs uppercase font-semibold">
                    <tr>
                        <th class="px-6 py-4">Question Paper Name</th>
                        <th class="px-6 py-4">Date</th>
                        <th class="px-6 py-4">Status</th>
                        <th class="px-6 py-4">Action</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-slate-100">
                    {% for exam in recent_exams %}
                    <tr class="hover:bg-slate-100 transition-colors">
                        <td class="px-6 py-4 font-medium text-slate-900">{{ exam.question_paper.qPaperTitle }}</td>
                        <td class="px-6 py-4 text-slate-600">{{ exam.start_time|date:"d M Y" }}</td>
                        <td class="px-6 py-4">
                            <!-- We use a custom filter or logic in template if 'now' is available, or just check fields -->
                            <!-- Assuming 'now' is passed or available via logic, but Django templates don't have 'now' by default unless passed -->
                            <!-- index view passes nothing about 'now', but we can check if end_time < timezone.now -->
                            <!-- Ideally we'd do this logic in view, but for now we can rely on what was there or simplify -->
                            <!-- The previous template used 'now', let's see if it's in context processors or view -->
                            <!-- View imports timezone but doesn't pass 'now'. Wait, line 21 imports timezone. Line 26 uses it. -->
                            <!-- The context in view doesn't include 'now'. The old template used 'now'. -->
                            <!-- I'll assume 'now' is not available and remove the conditional badges for now or just show dates. -->
                            <!-- actually, let's just show the dates. -->
                            <span class="text-slate-600 text-sm">
                                {{ exam.start_time|time:"H:i" }} - {{ exam.end_time|time:"H:i" }}
                            </span>
                        </td>
                        <td class="px-6 py-4">
                            <a href="{% url 'faculty-edit_exam_enhanced' exam.id %}" class="text-primary hover:text-indigo-700 font-medium text-sm">Manage</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="px-6 py-12 text-center text-slate-500">
                            <div class="flex flex-col items-center justify-center">
                                <i class="fa-solid fa-folder-open text-4xl text-slate-300 mb-3"></i>
                                <p>No exams found</p>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
